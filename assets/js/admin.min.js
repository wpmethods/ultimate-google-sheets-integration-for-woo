jQuery(document).ready((function(e){e("#ugsiw-generate-script").on("click",(function(s){s.preventDefault();var t=e(this),i=t.text();t.text("Generating...").prop("disabled",!0);var r=[];e("input[name='ugsiw_gs_selected_fields[]']:checked").each((function(){r.push(e(this).val())})),e.ajax({url:ugsiw_gs.ajax_url,type:"POST",data:{action:"ugsiw_generate_google_script",nonce:ugsiw_gs.nonce,fields:r},success:function(s){s.success?(e("#ugsiw-generated-script").val(s.data.script),e("#ugsiw-script-output").show(),e("html, body").animate({scrollTop:e("#ugsiw-script-output").offset().top-100},500)):alert("Error generating script. Please try again.")},error:function(){alert("Error generating script. Please try again.")},complete:function(){t.text(i).prop("disabled",!1)}})})),e("#ugsiw-copy-script").on("click",(function(){e("#ugsiw-generated-script")[0].select(),document.execCommand("copy"),e("#ugsiw-copy-status").show().fadeOut(2e3)})),e("input[name='ugsiw_gs_selected_fields[]']").each((function(){e(this).is(":disabled")&&e(this).prop("checked",!0)})),e("input[name='ugsiw_gs_selected_fields[]']").on("change",(function(){e(this).is(":disabled")&&!e(this).is(":checked")&&e(this).prop("checked",!0)})),e(".ugsiw-field-category h3").on("click",(function(){e(this).next(".ugsiw-fields-grid").slideToggle(300),e(this).find(".dashicons").toggleClass("dashicons-arrow-down dashicons-arrow-up")})),e("#ugsiw-field-search").on("keyup",(function(){var s=e(this).val().toLowerCase();e(".ugsiw-field-item").each((function(){e(this).find("label").text().toLowerCase().indexOf(s)>-1?e(this).show():e(this).hide()}))})),e(document).on("click","#ugsiw-add-script-url",(function(e){e.preventDefault();var s=jQuery("<div/>",{class:"ugsiw-script-url-row",style:"display:flex;gap:8px;margin-bottom:8px;"});s.append('<input type="url" name="ugsiw_gs_script_urls[]" placeholder="https://script.google.com/macros/s/..." style="flex:1;padding:10px;border:1px solid #ddd;border-radius:4px;">'),s.append('<button type="button" class="button ugsiw-remove-script-url">Remove</button>'),jQuery("#ugsiw-script-urls-list").append(s)})),e(document).on("click",".ugsiw-remove-script-url",(function(s){s.preventDefault(),e("#ugsiw-script-urls-list .ugsiw-script-url-row").length>1?e(this).closest(".ugsiw-script-url-row").remove():e(this).siblings("input").val("")}))}));